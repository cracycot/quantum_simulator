# 🎨 Обновление визуализации квантовой схемы

## Что изменилось?

### 1. **Легенда перенесена справа в вертикальную колонку**

**До:**
```
┌─────────────────────────────────────┐
│ Квантовая схема    [легенда в ряд]  │
├─────────────────────────────────────┤
│                                     │
│  |q0⟩ ──H──●──────────             │
│           │                         │
│  |q1⟩ ────⊕──X!───────             │
│                                     │
└─────────────────────────────────────┘
```

**После:**
```
┌─────────────────────────────────────────┐
│ Квантовая схема                         │
├───────────────────────┬─────────────────┤
│  INIT   ENCODE  ERROR │  🔴 X (Bit-flip)│
│                       │  🔵 Z (Phase-fl)│
│  |q0⟩ ──H──●─────    │  🟣 Y (Combined)│
│           │           │  🟢 H (Hadamard)│
│  |q1⟩ ────⊕──X!──    │  🟠 CNOT        │
│                       │  🔴 Шум (Noise) │
│                       │  🟠 Ошибка гейта│
│                       │  🟢 Коррекция   │
│                       │  🟣 Измерение   │
└───────────────────────┴─────────────────┘
```

### 2. **Этапы процесса подписаны сверху схемы**

Теперь над схемой отображаются этапы симуляции:

- **INIT** (зеленый) - Начальное состояние (H + CNOT для связывания)
- **ENCODE** (синий) - Выставляем гейты которые хотим
- **NOISE/ERROR** (красный) - Моделируется ошибка/шум
- **MEASUREMENT** (фиолетовый) - Определяем где возникла ошибка
- **CORRECTION** (зеленый) - Исправляем ошибку

Каждый этап:
- Имеет свой цвет
- Подписан сверху
- Визуально выделен цветной полосой
- Охватывает соответствующие колонки операций

---

## Технические изменения

### Новый компонент: `PhaseLabels`

```typescript
export const PhaseLabels: React.FC<{
  steps: QuantumStep[];
  width: number;
  columnWidth: number;
  padding: { left: number; right: number };
}>
```

**Что делает:**
- Анализирует последовательность шагов
- Группирует их по этапам (INIT, ENCODE, NOISE/ERROR, MEASUREMENT, CORRECTION)
- Отрисовывает цветные полосы с подписями над схемой

**Логика определения этапов:**
```typescript
if (step.type === 'encode' && desc.includes('initialize')) {
  phaseName = 'INIT';
} else if (step.type === 'encode') {
  phaseName = 'ENCODE';
} else if (step.type === 'noise' || step.type === 'gate-error') {
  phaseName = 'NOISE/ERROR';
} else if (step.type === 'measurement') {
  phaseName = 'MEASUREMENT';
} else if (step.type === 'correction') {
  phaseName = 'CORRECTION';
}
```

### Обновленный компонент: `CircuitLegend`

**Изменения:**
- Из горизонтального `flex flex-wrap` стал вертикальным `flex flex-col`
- Квадратики увеличены с `w-3 h-3` до `w-4 h-4`
- Добавлен `whitespace-nowrap` для текста
- Цвет текста изменен на `text-slate-300` для лучшей читаемости

### Интеграция в `QuantumCircuit`

**Изменения:**
```typescript
// Увеличен padding сверху для размещения этапов
style={{ minHeight: height + 72, paddingTop: '48px' }}

// Добавлен компонент PhaseLabels
<PhaseLabels 
  steps={steps}
  width={width}
  columnWidth={columnWidth}
  padding={padding}
/>
```

### Обновление layout в `App.tsx`

**До:**
```typescript
<div className="flex items-center justify-between mb-4">
  <h2>Квантовая схема</h2>
  <CircuitLegend />
</div>
<QuantumCircuit ... />
```

**После:**
```typescript
<h2>Квантовая схема</h2>
<div className="flex gap-4">
  <div className="flex-1">
    <QuantumCircuit ... />
  </div>
  <div className="flex-shrink-0">
    <CircuitLegend />
  </div>
</div>
```

---

## Визуальный результат

### Этапы над схемой

```
  ┌────────┐  ┌──────────┐  ┌───────────┐  ┌──────────┐  ┌──────────┐
  │  INIT  │  │  ENCODE  │  │NOISE/ERROR│  │MEASUREM't│  │CORRECTION│
  └────────┘  └──────────┘  └───────────┘  └──────────┘  └──────────┘
  ═══════════════════════════════════════════════════════════════════
  
  |q0⟩ ──H──●──────────X!────────M──────────X────────
           │
  |q1⟩ ────⊕──────────────────────────────────────────
```

### Легенда справа

```
  ┌─────────────────┐
  │ 🔴 X (Bit-flip) │
  │ 🔵 Z (Phase-fl) │
  │ 🟣 Y (Combined) │
  │ 🟢 H (Hadamard) │
  │ 🟠 CNOT         │
  │ 🔴 Шум (Noise)  │
  │ 🟠 Ошибка гейта │
  │ 🟢 Коррекция    │
  │ 🟣 Измерение    │
  └─────────────────┘
```

---

## Преимущества новой раскладки

### ✅ Улучшенная читаемость
- Легенда не загромождает верх
- Все элементы легенды видны сразу (вертикальная колонка)
- Больше места для схемы

### ✅ Образовательная ценность
- Четко видно какой этап симуляции происходит
- Цветовое кодирование помогает понять процесс
- Можно легко объяснить последовательность операций

### ✅ Удобство для демонстрации
- "Смотрите, сначала INIT - мы создаем суперпозицию и запутанность"
- "Потом NOISE/ERROR - вносим ошибку"
- "Затем MEASUREMENT - находим где ошибка"
- "И наконец CORRECTION - исправляем"

---

## Для защиты лабы

**Сценарий демонстрации:**

1. **Запустите симуляцию** (3-кубитный код, X-ошибка)

2. **Покажите этапы сверху:**
   - "Видите цветные полосы? Это этапы нашей симуляции"
   - "Зеленая полоса INIT - здесь мы создаем начальное состояние"
   - "Красная NOISE/ERROR - вносим ошибку"
   - "Фиолетовая MEASUREMENT - измеряем синдром"
   - "Зеленая CORRECTION - исправляем"

3. **Используйте легенду справа:**
   - "Справа вы видите легенду"
   - "🟢 H-гейт для суперпозиции"
   - "🟠 CNOT для запутанности"
   - "🔴 Красные блоки - это ошибки"
   - "🟢 Зеленые - коррекция"

4. **Объясните последовательность:**
   - Проведите пальцем слева направо по схеме
   - "Слева направо - временная последовательность"
   - "Сверху вниз - разные кубиты"
   - "Этапы сверху показывают что происходит"

---

## Файлы изменены

1. ✅ `src/components/QuantumCircuit.tsx`
   - Добавлен компонент `PhaseLabels`
   - Обновлен `CircuitLegend` (вертикальный)
   - Интегрированы этапы в render

2. ✅ `src/components/index.ts`
   - Экспортирован `PhaseLabels`

3. ✅ `src/App.tsx`
   - Изменен layout: схема слева, легенда справа

---

**Результат:** Более наглядная, образовательная и профессионально выглядящая схема квантовой коррекции ошибок! 🎉

